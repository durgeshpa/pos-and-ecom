Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Exception occurred 395
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 395
Exception occurred 1302
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1302
Exception occurred 1319
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1319
Exception occurred 57
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 57
Exception occurred 56
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 56
Exception occurred 228
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 228
Exception occurred 484
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 484
Exception occurred 586
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 586
Exception occurred 580
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 580
Exception occurred 581
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 581
Exception occurred 917
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 917
Exception occurred 1258
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1258
Exception occurred 1547
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1547
Exception occurred 111
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 111
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 16, in <module>
    populate_order(shop_id)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,None,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 156, in get_order_report
    ordered_sku_pieces = products.ordered_qty
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 684, in ordered_qty
    no_of_pieces = no_of_pieces.first().get('no_of_pieces')
AttributeError: 'NoneType' object has no attribute 'get'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 165, in get_order_report
    OrderReports.objects.using('gfanalytics').create(order_invoice = order_invoice, invoice_date = invoice_date, invoice_status = invoice_status, order_id = order_id, seller_shop = seller_shop,  order_status = order_status, order_date = order_date, order_by = order_by, retailer_id = retailer_id, pin_code = pin_code, product_id = product_id, product_name = product_name, product_brand = product_brand, product_mrp = product_mrp, product_value_tax_included = product_value_tax_included, ordered_sku_pieces = ordered_sku_pieces,  shipped_sku_pieces = shipped_sku_pieces, delivered_sku_pieces = delivered_sku_pieces, returned_sku_pieces = returned_sku_pieces, damaged_sku_pieces = damaged_sku_pieces, product_cgst = product_cgst, product_sgst = product_sgst, product_igst = product_igst, product_cess = product_cess, sales_person_name = sales_person_name, order_type = order_type, campaign_name = campaign_name, discount = discount)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/transaction.py", line 212, in __exit__
    connection.commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 261, in commit
    self._commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 239, in _commit
    return self.connection.commit()
KeyboardInterrupt
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Exception occurred 395
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 395
Exception occurred 1302
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 1302
Exception occurred 1319
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 1319
Exception occurred 57
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 57
Exception occurred 56
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 56
Exception occurred 228
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 228
Exception occurred 484
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 484
Exception occurred 586
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 586
Exception occurred 580
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 580
Exception occurred 581
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 581
Exception occurred 917
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 917
Exception occurred 1258
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 1258
Exception occurred 1547
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 1547
Exception occurred 111
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 593, in __init__
    product_price = product_price_map[product][0]
KeyError: 111
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 160, in get_order_report
    ordered_sku_pieces = products.ordered_qty
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 707, in ordered_qty
    no_of_pieces = no_of_pieces.first().get('no_of_pieces')
AttributeError: 'NoneType' object has no attribute 'get'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 169, in get_order_report
    OrderDetailReports.objects.using('gfanalytics').create(invoice_id = invoice_id, order_invoice = order_invoice, invoice_date = invoice_date, invoice_modified_at = invoice_modified_at, invoice_last_modified_by = shipment_last_modified_by, invoice_status = invoice_status, order_id = order_id, seller_shop = seller_shop,  order_status = order_status, order_date = order_date, order_modified_at = order_modified_at,  order_by = order_by, retailer_id = retailer_id, retailer_name =retailer_name, pin_code = pin_code, product_id = product_id, product_name = product_name, product_brand = product_brand, product_mrp = product_mrp, product_value_tax_included = product_value_tax_included, ordered_sku_pieces = ordered_sku_pieces,  shipped_sku_pieces = shipped_sku_pieces, delivered_sku_pieces = delivered_sku_pieces, returned_sku_pieces = returned_sku_pieces, damaged_sku_pieces = damaged_sku_pieces, product_cgst = product_cgst, product_sgst = product_sgst, product_igst = product_igst, product_cess = product_cess, sales_person_name = sales_person_name, order_type = order_type, campaign_name = campaign_name, discount = discount)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1294, in execute_sql
    cursor, self.query.get_meta().db_table, self.query.get_meta().pk.column
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django_redshift_backend/base.py", line 64, in last_insert_id
    pk=pk_name, table=self.quote_name(table_name)))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 83, in _execute
    return self.cursor.execute(sql)
  File "/usr/lib/python3.6/encodings/utf_8.py", line 15, in decode
    def decode(input, errors='strict'):
KeyboardInterrupt
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: relation "services_retailerreports" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 395, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1285, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: relation "services_retailerreports" does not exist

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: relation "services_retailerreports" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 395, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1285, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: relation "services_retailerreports" does not exist

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: relation "services_retailerreports" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 395, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1285, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: relation "services_retailerreports" does not exist

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: relation "services_retailerreports" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 395, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1285, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: relation "services_retailerreports" does not exist

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: relation "services_retailerreports" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 395, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 830, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 868, in _do_insert
    using=using, raw=raw)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/manager.py", line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1133, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1285, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: relation "services_retailerreports" does not exist

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
2019-07-15 19:12:55.238022
2019-07-15 19:39:28.163937
2019-07-15 19:12:55.238022
2019-07-15 19:39:28.163937
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
2019-07-15 19:12:55.238022
2019-07-15 19:39:28.163937
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity if products.product else ''
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity if products.product else ''
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity if products.product else ''
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 258, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity if products.product else ''
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 404, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_catprod_report.py", line 15, in <module>
    populate_category_product()
  File "populate_redshift_catprod_report.py", line 12, in populate_category_product
    cat_prod_report.get_category_product_report(None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 509, in get_category_product_report
    category_name = category.category.category_name
AttributeError: 'Category' object has no attribute 'category'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_catprod_report.py", line 15, in <module>
    populate_category_product()
  File "populate_redshift_catprod_report.py", line 12, in populate_category_product
    cat_prod_report.get_category_product_report(None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 510, in get_category_product_report
    category_name = category.category.category_name
AttributeError: 'Category' object has no attribute 'category'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_catprod_report.py", line 15, in <module>
    populate_category_product()
  File "populate_redshift_catprod_report.py", line 12, in populate_category_product
    cat_prod_report.get_category_product_report(None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 512, in get_category_product_report
    CategoryProductReports.objects.using('gfanalytics').create(product_id = product_id, product_name = product_name, product_short_description=product_short_description, product_created_at=product_created_at, category_id=category_id, category=category, category_name=category_name)
NameError: name 'CategoryProductReports' is not defined
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
2019-07-19 20:01:19.411189
2019-07-19 20:25:19.503710
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 220, in get_grn_report
    orders = orders.filter(created_at__gte = start_date)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 841, in filter
    return self._filter_or_exclude(False, *args, **kwargs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 859, in _filter_or_exclude
    clone.query.add_q(Q(*args, **kwargs))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/query.py", line 1263, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/query.py", line 1287, in _add_q
    split_subq=split_subq,
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/query.py", line 1225, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/query.py", line 1096, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/lookups.py", line 20, in __init__
    self.rhs = self.get_prep_lookup()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/lookups.py", line 70, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/__init__.py", line 1408, in get_prep_value
    value = super().get_prep_value(value)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/__init__.py", line 1268, in get_prep_value
    return self.to_python(value)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/__init__.py", line 1393, in to_python
    params={'value': value},
django.core.exceptions.ValidationError: ["'2019-07-1717:35:37' value has an invalid format. It must be in YYYY-MM-DD HH:MM[:ss[.uuuuuu]][TZ] format."]
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
2019-07-21 19:06:07.917923
2019-07-21 21:56:01.335360
Traceback (most recent call last):
  File "populate_redshift_master_report.py", line 3, in <module>
    import django
ImportError: No module named django
Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 402, in get_retailer_report
    RetailerReports.objects.using('gfanalytics').create(retailer_id = retailer_id, retailer_name = retailer_name, retailer_type=retailer_type, retailer_phone_number=retailer_phone_number, created_at=created_at, service_partner=service_partner, service_partner_id=service_partner_id, service_partner_contact=service_partner_contact)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/transaction.py", line 212, in __exit__
    connection.commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 261, in commit
    self._commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 239, in _commit
    return self.connection.commit()
KeyboardInterrupt
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 163, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/mixins.py", line 13, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'retailer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 387, in get_retailer_report
    retailer_id = retailer.retailer.id
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 177, in __get__
    rel_obj = self.get_object(instance)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 144, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 399, in get
    self.model._meta.object_name
shops.models.DoesNotExist: Shop matching query does not exist.
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 163, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/mixins.py", line 13, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'retailer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "populate_redshift_retailerreport.py", line 16, in <module>
    populate_retailer(shop_id)
  File "populate_redshift_retailerreport.py", line 12, in populate_retailer
    retailer_report.get_retailer_report(shop_id)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 387, in get_retailer_report
    retailer_id = retailer.retailer.id
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 177, in __get__
    rel_obj = self.get_object(instance)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/fields/related_descriptors.py", line 144, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 399, in get
    self.model._meta.object_name
shops.models.DoesNotExist: Shop matching query does not exist.
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
2019-08-30 15:53:38.707905
2019-08-30 17:02:37.628561
2019-09-04 10:31:58.904042
2019-09-04 14:56:45.910639
2019-09-05 20:45:14.585101
2019-09-05 20:45:14.585101
2019-09-06 08:26:44.500303
2019-09-05 20:45:14.585101
2019-09-06 14:13:55.636033
2019-09-11 16:58:03.558324
2019-09-11 16:14:19.197850
