Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Exception occurred 395
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 395
Exception occurred 1302
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1302
Exception occurred 1319
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1319
Exception occurred 57
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 57
Exception occurred 56
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 56
Exception occurred 228
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 228
Exception occurred 484
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 484
Exception occurred 586
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 586
Exception occurred 580
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 580
Exception occurred 581
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 581
Exception occurred 917
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 917
Exception occurred 1258
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1258
Exception occurred 1547
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 1547
Exception occurred 111
Traceback (most recent call last):
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 570, in __init__
    product_price = product_price_map[product][0]
KeyError: 111
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 16, in <module>
    populate_order(shop_id)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,None,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 156, in get_order_report
    ordered_sku_pieces = products.ordered_qty
  File "/home/ubuntu/project/retailer-backend/retailer_to_sp/models.py", line 684, in ordered_qty
    no_of_pieces = no_of_pieces.first().get('no_of_pieces')
AttributeError: 'NoneType' object has no attribute 'get'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 165, in get_order_report
    OrderReports.objects.using('gfanalytics').create(order_invoice = order_invoice, invoice_date = invoice_date, invoice_status = invoice_status, order_id = order_id, seller_shop = seller_shop,  order_status = order_status, order_date = order_date, order_by = order_by, retailer_id = retailer_id, pin_code = pin_code, product_id = product_id, product_name = product_name, product_brand = product_brand, product_mrp = product_mrp, product_value_tax_included = product_value_tax_included, ordered_sku_pieces = ordered_sku_pieces,  shipped_sku_pieces = shipped_sku_pieces, delivered_sku_pieces = delivered_sku_pieces, returned_sku_pieces = returned_sku_pieces, damaged_sku_pieces = damaged_sku_pieces, product_cgst = product_cgst, product_sgst = product_sgst, product_igst = product_igst, product_cess = product_cess, sales_person_name = sales_person_name, order_type = order_type, campaign_name = campaign_name, discount = discount)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 413, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 717, in save
    force_update=force_update, update_fields=update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/base.py", line 747, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/transaction.py", line 212, in __exit__
    connection.commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 261, in commit
    self._commit()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/base/base.py", line 239, in _commit
    return self.connection.commit()
KeyboardInterrupt
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "populate_redshift_grn_report.py", line 17, in <module>
    populate_grn(shop_id,start_date)
  File "populate_redshift_grn_report.py", line 12, in populate_grn
    grn_report.get_grn_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 251, in get_grn_report
    po_sku_pieces = grns.grn_order_grn_order_product.get(product = products.product).po_product_quantity
  File "/home/ubuntu/project/retailer-backend/gram_to_brand/models.py", line 395, in po_product_quantity
    return self.grn_order.order.ordered_cart.cart_list.filter(cart_product=self.product).last().qty if self.product else ''
AttributeError: 'NoneType' object has no attribute 'qty'
Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
Traceback (most recent call last):
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
psycopg2.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "populate_redshift_orderreport.py", line 17, in <module>
    populate_order(shop_id,start_date)
  File "populate_redshift_orderreport.py", line 12, in populate_order
    order_report.get_order_report(shop_id,start_date,None)
  File "/home/ubuntu/project/retailer-backend/services/views.py", line 122, in get_order_report
    for order in orders:
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 268, in __iter__
    self._fetch_all()
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 1183, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/query.py", line 54, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/models/sql/compiler.py", line 1061, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 100, in execute
    return super().execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/sentry_sdk/integrations/django/__init__.py", line 353, in execute
    return real_execute(self, sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 68, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 77, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/utils.py", line 89, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/ubuntu/project/prod/lib/python3.6/site-packages/django/db/backends/utils.py", line 85, in _execute
    return self.cursor.execute(sql, params)
django.db.utils.ProgrammingError: column retailer_to_sp_order.total_final_amount does not exist
LINE 1: ...ount", "retailer_to_sp_order"."total_tax_amount", "retailer_...
                                                             ^

Sentry is attempting to send 0 pending error messages
Waiting up to 2.0 seconds
Press Ctrl-C to quit
