from gram_to_brand.models import Cart, Order, GRNOrder, GRNOrderProductMapping
po = Cart.objects.last()
order = po.order_cart_mapping
grn_order = GRNOrder.objects.create(order=order, invoice_no="1234455")


#po product list
po.cart_list.all()

#grn count
po.order_cart_mapping.order_grn_order.last().grn_order_grn_order_product.count()
all_products = po.cart_list.all()
#all_grns = po.order_cart_mapping.order_grn_order.last().grn_order_grn_order_product.all()
import datetime
from datetime import timedelta
for temp_grn in all_grns:
    if temp_grn.delivered_qty < 1 and temp_grn.manufacture_date:
        expiry_date = datetime.datetime.today() + timedelta(days=364)
        manufacture_date = datetime.datetime.today() - timedelta(days=10)
        qty = temp_grn.grn_order.order.ordered_cart.cart_list.filter(cart_product=temp_grn.product).last().qty
	    new_grn = GRNOrderProductMapping.objects.create(product = temp_grn.product,grn_order = temp_grn.grn_order,
	     product_invoice_qty = qty,
	     delivered_qty = qty,
	     available_qty = qty,
	     manufacture_date = manufacture_date,
	     expiry_date = expiry_date,
	    )

for p in all_products:
    expiry_date = datetime.datetime.today() + timedelta(days=364)
    manufacture_date = datetime.datetime.today() - timedelta(days=10)
    qty = temp_grn.grn_order.order.ordered_cart.cart_list.filter(cart_product=temp_grn.product).last().qty
    new_grn = GRNOrderProductMapping.objects.create(product = temp_grn.product,grn_order = temp_grn.grn_order,
     product_invoice_qty = qty,
     delivered_qty = qty,
     available_qty = qty,
     manufacture_date = manufacture_date,
     expiry_date = expiry_date,
    )